<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="favicon.png?v=3">
    <title>ë‰´ìŠ¤ & ì¸ì‚¬ì´íŠ¸ | ë¹„ìÂ·ì¶œì…êµ­ ì •ë³´ | ë²•ë¬´ë²•ì¸ ë¡œì—°</title>

    <!-- SEO ë©”íƒ€ íƒœê·¸ -->
    <meta name="description" content="ì™¸êµ­ì¸ ë¹„ì, ì²´ë¥˜ìê²© ë³€ê²½, ì˜ì£¼ê¶Œ, ê·€í™” ë“± ì¶œì…êµ­ ê´€ë ¨ ìµœì‹  ì •ë³´ì™€ ì‹¤ë¬´ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë²•ë¬´ë²•ì¸ ë¡œì—° ì¶œì…êµ­ì´ë¯¼ì§€ì›ì„¼í„°ì˜ ì „ë¬¸ ì½˜í…ì¸ ì…ë‹ˆë‹¤.">
    <meta name="keywords" content="ë¹„ì, ì²´ë¥˜ìê²©, ì˜ì£¼ê¶Œ, ê·€í™”, ì™¸êµ­ì¸ë“±ë¡, ì¶œì…êµ­, ì´ë¯¼ë²•, E-7, D-2, F-4, F-5, ë²•ë¬´ë²•ì¸ ë¡œì—°">
    <meta name="author" content="ë²•ë¬´ë²•ì¸ ë¡œì—° ì¶œì…êµ­ì´ë¯¼ì§€ì›ì„¼í„°">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.lawyeonvisa.app/blog.html">

    <!-- Open Graph (Facebook, LinkedIn ë“±) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ë‰´ìŠ¤ & ì¸ì‚¬ì´íŠ¸ | ë¹„ìÂ·ì¶œì…êµ­ ì •ë³´ | ë²•ë¬´ë²•ì¸ ë¡œì—°">
    <meta property="og:description" content="ì™¸êµ­ì¸ ë¹„ì, ì²´ë¥˜ìê²© ë³€ê²½, ì˜ì£¼ê¶Œ, ê·€í™” ë“± ì¶œì…êµ­ ê´€ë ¨ ìµœì‹  ì •ë³´ì™€ ì‹¤ë¬´ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.">
    <meta property="og:url" content="https://www.lawyeonvisa.app/blog.html">
    <meta property="og:site_name" content="ë²•ë¬´ë²•ì¸ ë¡œì—° ì¶œì…êµ­ì´ë¯¼ì§€ì›ì„¼í„°">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:image" content="https://www.lawyeonvisa.app/images/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ë‰´ìŠ¤ & ì¸ì‚¬ì´íŠ¸ | ë²•ë¬´ë²•ì¸ ë¡œì—°">
    <meta name="twitter:description" content="ì™¸êµ­ì¸ ë¹„ì, ì²´ë¥˜ìê²© ë³€ê²½, ì˜ì£¼ê¶Œ, ê·€í™” ë“± ì¶œì…êµ­ ê´€ë ¨ ìµœì‹  ì •ë³´ì™€ ì‹¤ë¬´ ê°€ì´ë“œ">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8f9fa;
            color: #191f28;
            line-height: 1.6;
        }

        /* í—¤ë” */
        .header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 20px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 18px;
            font-weight: 600;
        }

        .header h1 a {
            color: white;
            text-decoration: none;
        }

        .header-nav {
            display: flex;
            gap: 24px;
        }

        .header-nav a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.2s;
        }

        .header-nav a:hover {
            color: white;
        }

        /* íˆì–´ë¡œ ì„¹ì…˜ */
        .hero {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 48px 24px 64px;
            text-align: center;
        }

        .hero h2 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .hero p {
            font-size: 16px;
            opacity: 0.8;
        }

        /* ì»¨í…Œì´ë„ˆ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* ì¹´í…Œê³ ë¦¬ íƒ­ */
        .category-tabs {
            display: flex;
            gap: 8px;
            padding: 24px 0;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .category-tab {
            padding: 10px 20px;
            background: white;
            border: 1px solid #e5e8eb;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            color: #4e5968;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .category-tab:hover {
            border-color: #3182f6;
            color: #3182f6;
        }

        .category-tab.active {
            background: #3182f6;
            border-color: #3182f6;
            color: white;
        }

        /* ë¸”ë¡œê·¸ ê·¸ë¦¬ë“œ */
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            padding-bottom: 64px;
        }

        @media (max-width: 900px) {
            .blog-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .blog-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ë¸”ë¡œê·¸ ì¹´ë“œ */
        .blog-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .blog-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.08);
        }

        .blog-card-thumbnail {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, #e8f4f8 0%, #d1e8ff 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .blog-card-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .blog-card-content {
            padding: 20px;
        }

        .blog-card-category {
            display: inline-block;
            padding: 4px 10px;
            background: #f2f4f6;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            color: #3182f6;
            margin-bottom: 12px;
        }

        .blog-card-title {
            font-size: 17px;
            font-weight: 600;
            color: #191f28;
            margin-bottom: 8px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .blog-card-excerpt {
            font-size: 14px;
            color: #6b7684;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .blog-card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: #8b95a1;
        }

        /* ë¡œë”© */
        .loading {
            text-align: center;
            padding: 48px;
            color: #8b95a1;
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #e5e8eb;
            border-top-color: #3182f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 64px 24px;
            color: #8b95a1;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* í‘¸í„° */
        .footer {
            background: #f8f9fa;
            border-top: 1px solid #e5e8eb;
            padding: 32px 24px;
            text-align: center;
            color: #8b95a1;
            font-size: 14px;
        }

        .footer a {
            color: #4e5968;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1><a href="index.html" data-i18n="common.lawFirm">ë²•ë¬´ë²•ì¸ ë¡œì—°</a></h1>
            <nav class="header-nav">
                <a href="index.html" data-i18n="blog.nav.services">ì„œë¹„ìŠ¤</a>
                <a href="blog.html" style="color: white; font-weight: 600;" data-i18n="blog.nav.newsInsights">ë‰´ìŠ¤ & ì¸ì‚¬ì´íŠ¸</a>
            </nav>
        </div>
    </header>

    <section class="hero">
        <h2 data-i18n="blog.title">ë‰´ìŠ¤ & ì¸ì‚¬ì´íŠ¸</h2>
        <p data-i18n="blog.subtitle">ì¶œì…êµ­Â·ë¹„ìì— ê´€í•œ ìœ ìš©í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤</p>
    </section>

    <main class="container">
        <div class="category-tabs" id="categoryTabs">
            <button class="category-tab active" data-category="all" data-i18n="blog.category.all">ì „ì²´</button>
            <button class="category-tab" data-category="citizenship" data-i18n="blog.category.citizenship">êµ­ì Â·ê·€í™”Â·ë‚œë¯¼</button>
            <button class="category-tab" data-category="admin" data-i18n="blog.category.admin">ê³µí†µ í–‰ì • ì‹ ê³ </button>
            <button class="category-tab" data-category="work" data-i18n="blog.category.work">ì·¨ì—…Â·ì›Œí¬</button>
            <button class="category-tab" data-category="education" data-i18n="blog.category.education">êµìœ¡Â·êµ¬ì§</button>
            <button class="category-tab" data-category="business" data-i18n="blog.category.business">ì‚¬ì—…Â·íˆ¬ì</button>
            <button class="category-tab" data-category="family" data-i18n="blog.category.family">ë™í¬Â·ê°€ì¡±Â·ê²°í˜¼</button>
            <button class="category-tab" data-category="residence" data-i18n="blog.category.residence">ê±°ì£¼Â·ì˜ì£¼</button>
        </div>

        <div id="blogList" class="blog-grid">
            <div class="loading">
                <div class="loading-spinner"></div>
                <p>ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>
    </main>

    <footer class="footer">
        <p data-i18n="blog.footer.copyright">Â© 2025 ë²•ë¬´ë²•ì¸ ë¡œì—°. All rights reserved.</p>
        <p style="margin-top: 8px;">
            <a href="privacy-policy.html" data-i18n="blog.footer.privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> Â·
            <a href="terms-of-service.html" data-i18n="blog.footer.terms">ì´ìš©ì•½ê´€</a>
        </p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ -->
    <script src="js/translations.js?v=20260206"></script>
    <script src="js/i18n.js?v=20260206"></script>
    <script>
        // Supabase ì´ˆê¸°í™”
        const SUPABASE_URL = 'https://gqistzsergddnpcvuzba.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdxaXN0enNlcmdkZG5wY3Z1emJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUxNTEyMjEsImV4cCI6MjA4MDcyNzIyMX0.X_GgShObq9OJ6z7aEKdUCoyHYo-OJL-I5hcIDt4komg';
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let currentCategory = 'all';

        // i18n í—¬í¼ í•¨ìˆ˜
        function t(key, fallback) {
            if (typeof i18n !== 'undefined' && i18n.translate) {
                const result = i18n.translate(key);
                return result !== key ? result : (fallback || key);
            }
            return fallback || key;
        }

        // ì¹´í…Œê³ ë¦¬ ë§¤í•‘ (ë™ì  ë²ˆì—­)
        function getCategoryName(cat) {
            const map = {
                'all': t('blog.category.all', 'ì „ì²´'),
                'citizenship': t('blog.category.citizenship', 'êµ­ì Â·ê·€í™”Â·ë‚œë¯¼'),
                'admin': t('blog.category.admin', 'ê³µí†µ í–‰ì • ì‹ ê³ '),
                'work': t('blog.category.work', 'ì·¨ì—…Â·ì›Œí¬'),
                'education': t('blog.category.education', 'êµìœ¡Â·êµ¬ì§'),
                'business': t('blog.category.business', 'ì‚¬ì—…Â·íˆ¬ì'),
                'family': t('blog.category.family', 'ë™í¬Â·ê°€ì¡±Â·ê²°í˜¼'),
                'residence': t('blog.category.residence', 'ê±°ì£¼Â·ì˜ì£¼')
            };
            return map[cat] || cat;
        }
        // í•˜ìœ„ í˜¸í™˜ì„±ì„ ìœ„í•œ ì¹´í…Œê³ ë¦¬ ë§¤í•‘ ê°ì²´
        const categoryNames = {
            'all': 'ì „ì²´',
            'citizenship': 'êµ­ì Â·ê·€í™”Â·ë‚œë¯¼',
            'admin': 'ê³µí†µ í–‰ì • ì‹ ê³ ',
            'work': 'ì·¨ì—…Â·ì›Œí¬',
            'education': 'êµìœ¡Â·êµ¬ì§',
            'business': 'ì‚¬ì—…Â·íˆ¬ì',
            'family': 'ë™í¬Â·ê°€ì¡±Â·ê²°í˜¼',
            'residence': 'ê±°ì£¼Â·ì˜ì£¼'
        };

        // ë¸”ë¡œê·¸ ê¸€ ë¡œë“œ
        async function loadPosts(category = 'all') {
            const blogList = document.getElementById('blogList');
            blogList.innerHTML = `<div class="loading"><div class="loading-spinner"></div><p>${t('blog.loading', 'ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...')}</p></div>`;

            try {
                // console.log('Loading posts, category:', category);

                let query = supabaseClient
                    .from('blog_posts')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (category !== 'all') {
                    query = query.eq('category', category);
                }

                // console.log('Executing query...');
                const { data: posts, error } = await query;
                // console.log('Query result:', { posts, error });

                // í…Œì´ë¸”ì´ ì—†ê±°ë‚˜ ì—ëŸ¬ì¸ ê²½ìš°
                if (error) {
                    console.error('Supabase error:', error);
                    // í…Œì´ë¸”ì´ ì—†ëŠ” ê²½ìš° ë¹ˆ ìƒíƒœë¡œ í‘œì‹œ
                    if (error.code === '42P01' || error.message?.includes('does not exist')) {
                        blogList.innerHTML = `
                            <div class="empty-state" style="grid-column: 1 / -1;">
                                <div class="empty-state-icon">ğŸ“</div>
                                <p>${t('blog.empty', 'ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.')}</p>
                            </div>
                        `;
                        return;
                    }
                    throw error;
                }

                if (!posts || posts.length === 0) {
                    blogList.innerHTML = `
                        <div class="empty-state" style="grid-column: 1 / -1;">
                            <div class="empty-state-icon">ğŸ“</div>
                            <p>${t('blog.empty', 'ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.')}</p>
                        </div>
                    `;
                    return;
                }

                blogList.innerHTML = posts.map(post => `
                    <article class="blog-card" onclick="location.href='blog-post.html?slug=${post.slug}'">
                        <div class="blog-card-thumbnail">
                            ${post.thumbnail_url
                                ? `<img src="${post.thumbnail_url}" alt="${post.title}">`
                                : getDefaultEmoji(post.category)
                            }
                        </div>
                        <div class="blog-card-content">
                            <span class="blog-card-category">${getCategoryName(post.category)}</span>
                            <h3 class="blog-card-title">${post.title}</h3>
                            <p class="blog-card-excerpt">${post.excerpt || ''}</p>
                            <div class="blog-card-meta">
                                <span>${formatDate(post.created_at)}</span>
                            </div>
                        </div>
                    </article>
                `).join('');

            } catch (error) {
                console.error('Error loading posts:', error);
                blogList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-state-icon">âš ï¸</div>
                        <p>${t('blog.error', 'ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')}</p>
                    </div>
                `;
            }
        }

        // ì¹´í…Œê³ ë¦¬ë³„ ê¸°ë³¸ ì´ëª¨ì§€
        function getDefaultEmoji(category) {
            const emojis = {
                'citizenship': 'ğŸ›‚',
                'admin': 'ğŸ“‹',
                'work': 'ğŸ’¼',
                'education': 'ğŸ“',
                'business': 'ğŸ¢',
                'family': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§',
                'residence': 'ğŸ '
            };
            return emojis[category] || 'ğŸ“„';
        }

        // ë‚ ì§œ í¬ë§·
        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
        }

        // ì¹´í…Œê³ ë¦¬ íƒ­ ì´ë²¤íŠ¸
        document.getElementById('categoryTabs').addEventListener('click', (e) => {
            if (e.target.classList.contains('category-tab')) {
                document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                currentCategory = e.target.dataset.category;
                loadPosts(currentCategory);
            }
        });

        // ì´ˆê¸° ë¡œë“œ
        loadPosts();
    </script>
</body>
</html>
